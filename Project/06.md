# Voeding

De voeding is nog een heikel punt. De 5V-outputpin van de Arduino UNO geeft maximum 400mA indien aangesloten op USB en 900mA indien aangesloten op externe voeding. De Adafruit Pro Trinket geraakt nog minder hoog. Onze led-strip daarentegen vereist een voltage van 5V en vermogen van 9W/m; wetend dat er 30 leds per meter staan, vereisen 64 (eigenlijk 192) leds een totaalvermogen van hoogstens 20W, dus een totaalstroom van hoogstens 4A. Zelfs als de leds niet allemaal tegelijk op volle kracht branden, hebben we meer stroom nodig dan de Arduino of Trinket kan leveren.

Daarom gebruiken we een externe voedingsbron. [Deze van Ohmeron](https://www.gotron.be/universele-voeding-met-vaste-uitgangsspanning-5v-3a.html) voorziet het geheel van een stabiele 5V spanning en 3A stroom. We moeten wel opletten dat we de Adafruit Pro Trinket dan niet voeden via de bedoelde `BAT+`-pin (bedoeld voor externe voeding) omdat die daar een spanning van minstens zo'n 5.5V verwacht en intern stabiliseert naar 5V; in plaats daarvan sluiten we de 5V meteen aan op de `5V`-pin. Dit werkt natuurlijk enkel omdat de externe voeding reeds een stabiele 5V bedraagt en dus niet nog eens door de interne spanningsregelaar moet lopen.

We geraken zo nog wel een paar voordelen kwijt en moeten even aandachtig zijn voor enkele details. Bijvoorbeeld, wanneer de Trinket tegelijkertijd aangesloten is op externe voeding op `BAT+` én op USB, dan kan die dynamisch selecteren welke voeding wordt gebruikt. Door dat te omzeilen moeten we nu zelf opletten dat er nooit te veel stroom uit de USB-poort van de computer wordt getrokken, of erger, omgekeerd door de USB-poort naar de laptop kan vloeien! Normaal heeft een moderne laptop daar weliswaar een ingebouwde beveiliging tegen, maar daar mogen we toch niet op vertrouwen…

Om rekening te houden met de situatie dat er tegelijkertijd externe voeding en USB aangesloten is, hebben we niet zo heel veel nodig. Blijkbaar zit er in de USB-poort van de Trinket een Schottkydiode die verhindert dat de externe stroom die we op de Trinket aansluiten, via de USB-poort naar een computer zou kunnen vloeien en problemen veroorzaken. Dat vergt dus geen extra aandacht. We moeten dan enkel nog verhinderen dat de led-strip te veel stroom uit de USB probeert te trekken, en dan kunnen we het eenvoudigst doen met een extra diode. Het enige "nadeel" is dan dat we tijdens het programmeren van de Adafruit Trinket helemaal geen leds zullen zien oplichten zonder externe stroom, maar dat lijkt een redelijke afweging.
